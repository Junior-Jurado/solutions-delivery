<div class="auth-container">
  <!-- Toast Notification -->
  <div class="toast-container" [class.show]="showToast">
    <div class="toast" [class.toast-success]="toastType === 'success'" 
                      [class.toast-error]="toastType === 'error'"
                      [class.toast-info]="toastType === 'info'">
      <div class="toast-icon">
        <svg *ngIf="toastType === 'success'" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
          <polyline points="22 4 12 14.01 9 11.01"></polyline>
        </svg>
        <svg *ngIf="toastType === 'error'" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="10"></circle>
          <line x1="15" y1="9" x2="9" y2="15"></line>
          <line x1="9" y1="9" x2="15" y2="15"></line>
        </svg>
        <svg *ngIf="toastType === 'info'" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="10"></circle>
          <line x1="12" y1="16" x2="12" y2="12"></line>
          <line x1="12" y1="8" x2="12.01" y2="8"></line>
        </svg>
      </div>
      <p>{{ toastMessage }}</p>
    </div>
  </div>

  <div class="auth-wrapper">
    <!-- Header -->
    <div class="auth-header">
      <div class="logo-container">
        <div class="logo-circle">
          <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path>
            <polyline points="3.29 7 12 12 20.71 7"></polyline>
            <line x1="12" y1="22" x2="12" y2="12"></line>
          </svg>
        </div>
      </div>
      <h1>EnvíoExpress</h1>
      <p>Tu plataforma de envíos confiable</p>
    </div>

    <!-- Tabs -->
    <div class="tabs-container">
      <!-- User Tab Content -->
      <div class="tab-content">
        <div class="card">
          <div class="card-header">
            <h2>
              {{ authTab === 'login' ? 'Iniciar Sesión' : 
                 authTab === 'register' ? 'Crear Cuenta' : 
                 'Confirmar Correo' }}
            </h2>
            <p>
              {{ authTab === 'login' 
                ? 'Accede para rastrear tus envíos y gestionar tus paquetes'
                : authTab === 'register'
                ? 'Regístrate como cliente para comenzar a enviar paquetes'
                : 'Ingresa el código que enviamos a tu correo electrónico'
              }}
            </p>
          </div>
          <div class="card-content">
            <!-- Login Form -->
            <form *ngIf="authTab === 'login'" (ngSubmit)="handleLogin($event)" class="form">
              <div class="form-group">
                <label>Correo electrónico</label>
                <input 
                  type="email" 
                  [(ngModel)]="email" 
                  name="email" 
                  required 
                  [disabled]="isLoading"
                  [class.input-error]="emailError"
                  autocomplete="email"
                />
                <span *ngIf="emailError" class="error-message">{{ emailError }}</span>
              </div>

              <div class="form-group">
                <label>Contraseña</label>
                <input 
                  type="password" 
                  [(ngModel)]="password" 
                  name="password" 
                  required 
                  [disabled]="isLoading"
                  [class.input-error]="passwordError"
                  autocomplete="current-password"
                />
                <span *ngIf="passwordError" class="error-message">{{ passwordError }}</span>
              </div>

              <button type="submit" class="btn btn-primary" [disabled]="isLoading">
                <span *ngIf="!isLoading">Iniciar sesión</span>
                <span *ngIf="isLoading" class="loading-content">
                  <span class="spinner"></span>
                  Iniciando sesión...
                </span>
              </button>

              <p class="form-footer">
                ¿No tienes cuenta?
                <button 
                  type="button" 
                  (click)="switchToRegister()" 
                  class="link-button"
                  [disabled]="isLoading">
                  Regístrate aquí
                </button>
              </p>
            </form>

            <!-- Register Form -->
            <form *ngIf="authTab === 'register'" (ngSubmit)="handleRegister($event)" class="form">
              <div class="form-group">
                <label for="reg-fullname">Nombre completo *</label>
                <input
                  id="reg-fullname"
                  type="text"
                  placeholder="Juan Pérez"
                  [(ngModel)]="regFullName"
                  name="regFullName"
                  required
                  [disabled]="isLoading"
                  [class.input-error]="regFullNameError"
                  autocomplete="name"
                />
                <span *ngIf="regFullNameError" class="error-message">{{ regFullNameError }}</span>
              </div>
              <div class="form-group">
                <label for="reg-email">Correo electrónico *</label>
                <input
                  id="reg-email"
                  type="email"
                  placeholder="usuario@ejemplo.com"
                  [(ngModel)]="regEmail"
                  name="regEmail"
                  required
                  [disabled]="isLoading"
                  [class.input-error]="regEmailError"
                  autocomplete="email"
                />
                <span *ngIf="regEmailError" class="error-message">{{ regEmailError }}</span>
              </div>
              <div class="form-group">
                <label for="reg-phone">Teléfono</label>
                <input
                  id="reg-phone"
                  type="tel"
                  placeholder="+57 300 123 4567"
                  [(ngModel)]="regPhone"
                  name="regPhone"
                  [disabled]="isLoading"
                  [class.input-error]="regPhoneError"
                  autocomplete="tel"
                />
                <span *ngIf="regPhoneError" class="error-message">{{ regPhoneError }}</span>
              </div>
              <div class="form-row">
                <div class="form-group">
                  <label for="reg-type-doc">Tipo de documento</label>
                  <select 
                    id="reg-type-doc"
                    [(ngModel)]="regTypeDocument"
                    name="regTypeDocument"
                    [disabled]="isLoading"
                    [class.input-error]="regTypeDocumentError">
                    <option value="" disabled>Seleccionar</option>
                    <option value="CC">Cédula de Ciudadanía</option>
                    <option value="CE">Cédula de Extranjería</option>
                    <option value="NIT">NIT</option>
                    <option value="PP">Pasaporte</option>
                  </select>
                  <span *ngIf="regTypeDocumentError" class="error-message">{{ regTypeDocumentError }}</span>
                </div>
                <div class="form-group">
                  <label for="reg-number-doc">Número de documento</label>
                  <input
                    id="reg-number-doc"
                    type="text"
                    placeholder="123456789"
                    [(ngModel)]="regNumberDocument"
                    name="regNumberDocument"
                    [disabled]="isLoading"
                    [class.input-error]="regNumberDocumentError"
                  />
                  <span *ngIf="regNumberDocumentError" class="error-message">{{ regNumberDocumentError }}</span>
                </div>
              </div>
              <div class="form-group">
                <label for="reg-password">Contraseña *</label>
                <input
                  id="reg-password"
                  type="password"
                  placeholder="••••••••"
                  [(ngModel)]="regPassword"
                  name="regPassword"
                  required
                  [disabled]="isLoading"
                  [class.input-error]="regPasswordError"
                  autocomplete="new-password"
                />
                <span *ngIf="regPasswordError" class="error-message">{{ regPasswordError }}</span>
                <small class="input-hint">Mínimo 8 caracteres, incluye mayúsculas, minúsculas, números y caracteres especiales</small>
              </div>
              <button type="submit" class="btn btn-primary" [disabled]="isLoading">
                <span *ngIf="!isLoading">Crear Cuenta</span>
                <span *ngIf="isLoading" class="loading-content">
                  <span class="spinner"></span>
                  Creando cuenta...
                </span>
              </button>
              <p class="form-footer">
                ¿Ya tienes cuenta?
                <button 
                  type="button" 
                  (click)="switchToLogin()" 
                  class="link-button"
                  [disabled]="isLoading">
                  Inicia sesión
                </button>
              </p>
            </form>

            <!-- Confirm Email Form -->
            <form *ngIf="authTab === 'confirm'" (ngSubmit)="handleConfirmEmail($event)" class="form">
              <div class="confirm-info">
                <div class="info-box">
                  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect width="20" height="16" x="2" y="4" rx="2"></rect>
                    <path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"></path>
                  </svg>
                  <p>Código enviado a: <strong>{{ confirmEmail }}</strong></p>
                </div>
              </div>

              <div class="form-group">
                <label for="confirm-code">Código de confirmación</label>
                <input
                  id="confirm-code"
                  type="text"
                  placeholder="123456"
                  [(ngModel)]="confirmCode"
                  name="confirmCode"
                  required
                  maxlength="6"
                  [disabled]="isLoading"
                  [class.input-error]="confirmCodeError"
                  autocomplete="one-time-code"
                />
                <span *ngIf="confirmCodeError" class="error-message">{{ confirmCodeError }}</span>
              </div>

              <button type="submit" class="btn btn-primary" [disabled]="isLoading">
                <span *ngIf="!isLoading">Confirmar Correo</span>
                <span *ngIf="isLoading" class="loading-content">
                  <span class="spinner"></span>
                  Confirmando...
                </span>
              </button>

              <div class="resend-section">
                <p>¿No recibiste el código?</p>
                <button 
                  type="button" 
                  (click)="handleResendCode()" 
                  class="btn-link"
                  [disabled]="isResendingCode || isLoading">
                  <span *ngIf="!isResendingCode">Reenviar código</span>
                  <span *ngIf="isResendingCode" class="loading-content">
                    <span class="spinner-small"></span>
                    Reenviando...
                  </span>
                </button>
              </div>

              <p class="form-footer">
                <button 
                  type="button" 
                  (click)="switchToLogin()" 
                  class="link-button"
                  [disabled]="isLoading">
                  Volver al inicio de sesión
                </button>
              </p>
            </form>
          </div>
        </div>
      </div>
    </div>

    <!-- Back to Home -->
    <div class="back-link">
      <button class="btn-link" (click)="goHome()" [disabled]="isLoading">
        Volver al inicio
      </button>
    </div>
  </div>
</div>